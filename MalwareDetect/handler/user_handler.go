package handler

import (
	"MalwareDetect/service"
	"MalwareDetect/util/response"
	"github.com/gin-gonic/gin"
)

// Info .
// @router /api/auth/info [POST]
func Info(ctx *gin.Context) {
	userInfo := service.CoreUserService.UserInfo(ctx)
	response.Success(ctx, "", gin.H{"user": userInfo})
}

// Login .
// @router /api/auth/login [POST]
func Login(ctx *gin.Context) {
	token, err := service.CoreUserService.Login(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), gin.H{"token": token})
		return
	}
	response.Success(ctx, "login success", gin.H{"token": token})
}

// Register .
// @router /api/auth/register [POST]
func Register(ctx *gin.Context) {
	token, err := service.CoreUserService.Register(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), gin.H{"token": token})
		return
	}
	response.Success(ctx, "register success", gin.H{"token": token})
}
