package handler

import (
	"MalwareDetect/service"
	"MalwareDetect/util/response"
	"fmt"
	"github.com/gin-gonic/gin"
)

func MalwareCreate(ctx *gin.Context) {
	malware, err := service.CoreMalwareService.Create(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), nil)
		return
	}
	response.Success(ctx, "创建成功", gin.H{"malware": malware})
}

func MalwareUpdate(ctx *gin.Context) {
	malware, err := service.CoreMalwareService.Update(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), nil)
		return
	}
	response.Success(ctx, "更新成功", gin.H{"malware": malware})
}

func MalwareShow(ctx *gin.Context) {
	malware, err := service.CoreMalwareService.Show(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), nil)
		return
	}
	response.Success(ctx, "", gin.H{"malware": malware})
}

func MalwareDelete(ctx *gin.Context) {
	malware, err := service.CoreMalwareService.Delete(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), nil)
		return
	}
	response.Success(ctx, "删除成功", gin.H{"malware": malware})
}

func MalwareList(ctx *gin.Context) {
	ginRsp, err := service.CoreMalwareService.PageList(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), nil)
		return
	}
	response.Success(ctx, "malware list return success", ginRsp)
}

func UploadMalware(ctx *gin.Context) {
	fileInfo, err := service.CoreMalwareService.UploadFile(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), nil)
		return
	}
	response.Success(ctx, fmt.Sprintf("写入成功"), fileInfo)
}

func GetReport(ctx *gin.Context) {
	fileInfo, err := service.CoreMalwareService.GetReport(ctx)
	if err != nil {
		response.Fail(ctx, err.Error(), nil)
		return
	}
	response.Success(ctx, fmt.Sprintf("返回报告成功"), fileInfo)
}
